{% extends "base.html" %}
{% block content %}

<h3 class="center-align">All Books</h3>

<!-- Search bar -->
<div class="row card-panel grey lighten-5">
  <form action="{{ url_for('search') }}" method="post" class="col s12">
    <div class="row valign-wrapper center-align">
      <div class="input-field col s12 m8">
        <i class="prefix search"></i>
        <input type="text" name="query" id="query" minlength="3" class="validate" required />
        <label for="query">Search books</label>
      </div>
      <div class="col s12 m4">
        <button type="submit" class="btn-large button-cancel text-shadow">
          <i class="material-icons">search</i>
        </button>
        <a href="{{ url_for('get_books') }}" class="red btn btn-large text-shadow"> <i
            class="material-icons">cancel</i></a>
      </div>
    </div>
  </form>
</div>

{% if books.count() > 0 %}

<div class="row">
  {% for book in books %}
  <div class="col s10 offset-s1 m6 l4 xl3">
    <div class="card hoverable z-depth-2">
      <div class="card-image">
        <img src="{{ book.book_image }}" alt="Book cover image" />
        <a href="{{ url_for('book_page', book_id=book._id) }}"
          class="btn-floating halfway-fab waves-effect waves-light red hoverable" aria-label="open book review button">
          <i></i>
        </a>
      </div>
      <div class="card-content center-align">
        <span class="card-title truncate">{{ book.book_name }}</span>
        <span class="card-text-sm truncate">{{ book.book_author }}</span><br />
        <span class="card-text-sm truncate"><strong><em>{{ book.genre_name }}</em></strong></span>
      </div>
      <div class="card-action center-align">
        {% if session.user|lower == book.created_by|lower %}
        <a href="{{ url_for('delete_book', book_id=book._id) }}" class="waves-effect waves-light btn s3">Delete</a>
        <a href="{{ url_for('edit_book', book_id=book._id) }}" class="waves-effect waves-light btn s3">Edit</a>
        {% endif %}
      </div>
    </div>
  </div>

  {% endfor %}
</div>
{% else %}
<h3 class="center-align red-text">No results found</h3>
{% endif %} {% endblock %}